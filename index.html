<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSS | Enterprise Unified Core</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, where, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBSQdizSB5wJX4jvGw1oqJRClHthS3jvrw",
            authDomain: "global-school-system-e7861.firebaseapp.com",
            projectId: "global-school-system-e7861",
            storageBucket: "global-school-system-e7861.firebasestorage.app",
            messagingSenderId: "806768742777",
            appId: "1:806768742777:web:ac5256a50e4e21faf51fa8"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        window.fs = { collection, addDoc, getDocs, query, orderBy, where, serverTimestamp };
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
                    colors: { brand: { 50:'#eef2ff', 100:'#e0e7ff', 200:'#c7d2fe', 500:'#4f46e5', 600:'#4338ca', 700:'#3730a3', 900:'#1e1b4b' } }
                }
            }
        }
    </script>

    <style>
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .sidebar-active { background: #4f46e5; color: white; box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.4); }
        .sidebar-active i { opacity: 1 !important; }
        .nav-hover:hover { background: rgba(255, 255, 255, 0.05); color: white; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeScale { from { opacity: 0; transform: scale(0.96); } to { opacity: 1; transform: scale(1); } }
        @keyframes pulse-soft { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
        @keyframes countUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .animate-view { animation: slideIn 0.4s ease-out forwards; }
        .animate-card { animation: fadeScale 0.5s ease-out forwards; }
        .animate-count { animation: countUp 0.6s ease-out forwards; }
        .card { @apply bg-white rounded-[2rem] shadow-sm border border-slate-100 transition-all duration-300; }
        .card:hover { box-shadow: 0 20px 40px -12px rgba(0,0,0,0.08); transform: translateY(-2px); }
        .stat-icon { @apply w-14 h-14 rounded-2xl flex items-center justify-center text-xl; }
        .table-row { @apply px-6 py-4 bg-slate-50/50 rounded-2xl flex items-center justify-between hover:bg-brand-50 transition-colors cursor-pointer; }
        .badge { @apply px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wider; }
        .typing-dot { animation: pulse-soft 1.2s ease-in-out infinite; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 100px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .progress-bar { transition: width 1.5s ease-out; }
        .notif-badge { @apply absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-[9px] font-black rounded-full flex items-center justify-center; }
    </style>
</head>
<body class="bg-[#f8fafc] text-slate-900 antialiased h-screen overflow-hidden font-sans">

    <!-- ================= LOGIN PAGE ================= -->
    <div id="loginPage" class="fixed inset-0 z-[100] flex items-center justify-center overflow-hidden">
        <!-- Sky Background -->
        <div class="absolute inset-0 bg-gradient-to-b from-[#3b7dd8] via-[#5a9de6] to-[#87CEEB]"></div>

        <!-- Clouds -->
        <div class="absolute top-[8%] left-[5%] w-32 h-12 bg-white/50 rounded-full blur-sm"></div>
        <div class="absolute top-[6%] left-[8%] w-24 h-10 bg-white/60 rounded-full blur-sm"></div>
        <div class="absolute top-[12%] right-[10%] w-36 h-12 bg-white/50 rounded-full blur-sm"></div>
        <div class="absolute top-[10%] right-[12%] w-28 h-10 bg-white/60 rounded-full blur-sm"></div>
        <div class="absolute top-[18%] left-[30%] w-20 h-8 bg-white/40 rounded-full blur-sm"></div>
        <div class="absolute top-[5%] left-[50%] w-28 h-10 bg-white/45 rounded-full blur-sm"></div>
        <div class="absolute top-[15%] right-[30%] w-24 h-8 bg-white/35 rounded-full blur-sm"></div>

        <!-- Illustrated Cityscape SVG -->
        <svg class="absolute bottom-0 left-0 w-full" viewBox="0 0 1440 520" preserveAspectRatio="xMidYMax slice" xmlns="http://www.w3.org/2000/svg">
            <!-- Distant hills -->
            <ellipse cx="400" cy="520" rx="600" ry="180" fill="#5a8f3e" opacity="0.3"/>
            <ellipse cx="1100" cy="520" rx="500" ry="160" fill="#5a8f3e" opacity="0.25"/>

            <!-- Ground -->
            <rect x="0" y="340" width="1440" height="200" fill="#4a9e3a"/>
            <rect x="0" y="380" width="1440" height="160" fill="#3d8a30"/>

            <!-- Road -->
            <rect x="0" y="370" width="1440" height="30" fill="#6b7280" rx="2"/>
            <line x1="0" y1="385" x2="1440" y2="385" stroke="#fbbf24" stroke-width="2" stroke-dasharray="20,15"/>

            <!-- Back row buildings -->
            <!-- Tall office left -->
            <rect x="50" y="180" width="70" height="190" fill="#4a6fa5" rx="4"/>
            <rect x="55" y="188" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="71" y="188" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="87" y="188" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="103" y="188" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/>
            <rect x="55" y="208" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="71" y="208" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="87" y="208" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="103" y="208" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="55" y="228" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="71" y="228" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="87" y="228" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="103" y="228" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/>
            <rect x="55" y="248" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="71" y="248" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="87" y="248" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="103" y="248" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="55" y="268" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="71" y="268" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="87" y="268" width="12" height="14" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="103" y="268" width="12" height="14" fill="#87CEEB" opacity="0.5" rx="1"/>

            <!-- School building center-left -->
            <rect x="200" y="230" width="140" height="140" fill="#c0392b" rx="4"/>
            <rect x="200" y="220" width="140" height="16" fill="#a93226" rx="3"/>
            <polygon points="270,185 200,220 340,220" fill="#922b21"/>
            <!-- School windows -->
            <rect x="212" y="242" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="240" y="242" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="268" y="242" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="296" y="242" width="20" height="24" fill="#f5d6a8" rx="2"/>
            <rect x="212" y="278" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="240" y="278" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="268" y="278" width="20" height="24" fill="#f5d6a8" rx="2"/><rect x="296" y="278" width="20" height="24" fill="#f5d6a8" rx="2"/>
            <!-- School door -->
            <rect x="255" y="326" width="30" height="44" fill="#6b3a2a" rx="3"/>
            <circle cx="280" cy="350" r="2" fill="#f59e0b"/>

            <!-- Clock tower -->
            <rect x="260" y="155" width="20" height="30" fill="#d4a373"/>
            <circle cx="270" cy="168" r="7" fill="white" stroke="#333" stroke-width="1.5"/>
            <line x1="270" y1="168" x2="270" y2="163" stroke="#333" stroke-width="1.5"/>
            <line x1="270" y1="168" x2="274" y2="168" stroke="#333" stroke-width="1"/>
            <polygon points="270,142 255,158 285,158" fill="#a0522d"/>

            <!-- Apartment block right side -->
            <rect x="1050" y="200" width="90" height="170" fill="#5b7eaa" rx="4"/>
            <rect x="1058" y="210" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1078" y="210" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1098" y="210" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1118" y="210" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="1058" y="232" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1078" y="232" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1098" y="232" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1118" y="232" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/>
            <rect x="1058" y="254" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1078" y="254" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1098" y="254" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1118" y="254" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="1058" y="276" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1078" y="276" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1098" y="276" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1118" y="276" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/>
            <rect x="1058" y="298" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1078" y="298" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1098" y="298" width="14" height="16" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1118" y="298" width="14" height="16" fill="#87CEEB" opacity="0.6" rx="1"/>

            <!-- Church/tall building far right -->
            <rect x="1280" y="210" width="60" height="160" fill="#d4a574" rx="3"/>
            <polygon points="1310,170 1280,210 1340,210" fill="#b8956a"/>
            <rect x="1295" y="240" width="30" height="40" fill="#f5d6a8" rx="8 8 0 0"/>
            <rect x="1295" y="300" width="12" height="20" fill="#87CEEB" opacity="0.5" rx="1"/><rect x="1313" y="300" width="12" height="20" fill="#87CEEB" opacity="0.5" rx="1"/>
            <rect x="1306" y="340" width="18" height="30" fill="#6b3a2a" rx="2"/>
            <!-- Cross -->
            <rect x="1307" y="158" width="6" height="18" fill="#d4a574"/><rect x="1302" y="163" width="16" height="5" fill="#d4a574"/>

            <!-- Houses -->
            <rect x="450" y="280" width="80" height="90" fill="#e8c170" rx="3"/>
            <polygon points="490,240 445,280 535,280" fill="#c0392b"/>
            <rect x="470" y="300" width="18" height="22" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="496" y="300" width="18" height="22" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="480" y="338" width="20" height="32" fill="#6b3a2a" rx="2"/>

            <rect x="900" y="270" width="90" height="100" fill="#dda15e" rx="3"/>
            <polygon points="945,230 895,270 995,270" fill="#bc6c25"/>
            <rect x="916" y="290" width="18" height="22" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="942" y="290" width="18" height="22" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="930" y="338" width="22" height="32" fill="#6b3a2a" rx="2"/>

            <rect x="1170" y="280" width="70" height="90" fill="#e0c9a6" rx="3"/>
            <polygon points="1205,245 1165,280 1245,280" fill="#a0522d"/>
            <rect x="1182" y="300" width="16" height="20" fill="#87CEEB" opacity="0.6" rx="1"/><rect x="1206" y="300" width="16" height="20" fill="#87CEEB" opacity="0.6" rx="1"/>
            <rect x="1192" y="338" width="18" height="32" fill="#6b3a2a" rx="2"/>

            <!-- Small building far left -->
            <rect x="580" y="290" width="60" height="80" fill="#7faacc" rx="3"/>
            <rect x="580" y="282" width="60" height="12" fill="#6b94b8" rx="2"/>
            <rect x="588" y="304" width="14" height="16" fill="#f5d6a8" rx="1"/><rect x="608" y="304" width="14" height="16" fill="#f5d6a8" rx="1"/><rect x="628" y="304" width="8" height="16" fill="#f5d6a8" rx="1"/>
            <rect x="600" y="338" width="18" height="32" fill="#5a7fa0" rx="2"/>

            <!-- Trees (round canopy style) -->
            <rect x="158" y="310" width="10" height="60" fill="#5d4037"/>
            <circle cx="163" cy="295" r="28" fill="#2d7d2d"/><circle cx="148" cy="305" r="20" fill="#268026"/><circle cx="178" cy="305" r="22" fill="#2e8b2e"/>

            <rect x="385" y="310" width="8" height="55" fill="#5d4037"/>
            <circle cx="389" cy="298" r="24" fill="#2d7d2d"/><circle cx="375" cy="306" r="18" fill="#268026"/><circle cx="403" cy="308" r="19" fill="#2e8b2e"/>

            <rect x="690" y="310" width="10" height="55" fill="#5d4037"/>
            <circle cx="695" cy="298" r="26" fill="#2d7d2d"/><circle cx="680" cy="306" r="20" fill="#268026"/><circle cx="712" cy="308" r="20" fill="#2e8b2e"/>

            <rect x="830" y="318" width="8" height="48" fill="#5d4037"/>
            <circle cx="834" cy="305" r="22" fill="#2d7d2d"/><circle cx="822" cy="312" r="16" fill="#268026"/><circle cx="848" cy="313" r="17" fill="#2e8b2e"/>

            <rect x="1010" y="310" width="10" height="55" fill="#5d4037"/>
            <circle cx="1015" cy="298" r="26" fill="#2d7d2d"/><circle cx="1000" cy="306" r="20" fill="#268026"/><circle cx="1030" cy="308" r="21" fill="#2e8b2e"/>

            <rect x="1370" y="318" width="8" height="48" fill="#5d4037"/>
            <circle cx="1374" cy="305" r="22" fill="#2d7d2d"/><circle cx="1362" cy="312" r="16" fill="#268026"/><circle cx="1388" cy="313" r="17" fill="#2e8b2e"/>

            <!-- Small bushes on grass -->
            <ellipse cx="100" cy="400" rx="22" ry="14" fill="#2a7a2a"/>
            <ellipse cx="500" cy="410" rx="18" ry="10" fill="#2a7a2a"/>
            <ellipse cx="750" cy="395" rx="20" ry="12" fill="#2a7a2a"/>
            <ellipse cx="1200" cy="405" rx="16" ry="10" fill="#2a7a2a"/>
            <ellipse cx="1400" cy="398" rx="22" ry="12" fill="#2a7a2a"/>

            <!-- Fence posts along the road -->
            <g fill="#e0e0e0">
                <rect x="60" y="352" width="4" height="20" rx="1"/><rect x="120" y="352" width="4" height="20" rx="1"/><rect x="180" y="352" width="4" height="20" rx="1"/><rect x="240" y="352" width="4" height="20" rx="1"/><rect x="300" y="352" width="4" height="20" rx="1"/><rect x="360" y="352" width="4" height="20" rx="1"/>
                <rect x="1100" y="352" width="4" height="20" rx="1"/><rect x="1160" y="352" width="4" height="20" rx="1"/><rect x="1220" y="352" width="4" height="20" rx="1"/><rect x="1280" y="352" width="4" height="20" rx="1"/><rect x="1340" y="352" width="4" height="20" rx="1"/><rect x="1400" y="352" width="4" height="20" rx="1"/>
            </g>
            <rect x="60" y="358" width="304" height="3" fill="#e0e0e0" rx="1"/>
            <rect x="1100" y="358" width="344" height="3" fill="#e0e0e0" rx="1"/>
        </svg>

        <!-- Login Content -->
        <div class="relative z-10 flex flex-col items-center animate-view px-4">
            <!-- Logo -->
            <div class="flex items-center gap-3 mb-1">
                <div class="w-14 h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-lg border border-white/30">
                    <i class="fas fa-graduation-cap text-white text-2xl"></i>
                </div>
                <h1 class="text-white text-4xl font-black tracking-tight" style="text-shadow: 0 2px 10px rgba(0,0,0,0.15);">GSMS</h1>
            </div>
            <p class="text-white/90 text-base font-semibold mb-8 tracking-wide" style="text-shadow: 0 1px 6px rgba(0,0,0,0.1);">Global School Management System</p>

            <!-- Login Card -->
            <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-[380px]" style="box-shadow: 0 25px 60px -12px rgba(0,0,0,0.25);">
                <div class="space-y-5">
                    <!-- Role Selector -->
                    <div>
                        <label class="flex items-center gap-2 text-sm font-bold text-slate-600 mb-2">
                            <i class="fas fa-user-tag text-[#3b7dd8] text-xs"></i> Login As
                        </label>
                        <select id="loginRole" class="w-full px-4 py-3.5 bg-white border-2 border-slate-200 rounded-xl font-semibold text-slate-700 outline-none focus:border-[#3b7dd8] transition-colors text-sm cursor-pointer">
                            <option value="SUPER_ADMIN">&#x1f451; Super Admin</option>
                            <option value="SCHOOL_ADMIN">&#x1f3eb; School Admin</option>
                            <option value="TEACHER">&#x1f469;&#x200d;&#x1f3eb; Teacher</option>
                            <option value="PARENT">&#x1f46a; Parent</option>
                            <option value="STUDENT">&#x1f393; Student</option>
                        </select>
                    </div>

                    <!-- Email -->
                    <div>
                        <label class="flex items-center gap-2 text-sm font-bold text-slate-600 mb-2">
                            <i class="fas fa-envelope text-[#3b7dd8] text-xs"></i> Email Address
                        </label>
                        <input id="loginId" type="email" placeholder="admin@school.com" value="admin@school.com" class="w-full px-4 py-3.5 bg-white border-2 border-slate-200 rounded-xl font-medium text-slate-700 outline-none focus:border-[#3b7dd8] transition-colors text-sm">
                    </div>

                    <!-- Password -->
                    <div>
                        <label class="flex items-center gap-2 text-sm font-bold text-slate-600 mb-2">
                            <i class="fas fa-lock text-[#3b7dd8] text-xs"></i> Password
                        </label>
                        <div class="relative">
                            <input id="loginPass" type="password" value="password123" class="w-full px-4 py-3.5 bg-white border-2 border-slate-200 rounded-xl font-medium text-slate-700 outline-none focus:border-[#3b7dd8] transition-colors text-sm pr-12">
                            <button type="button" onclick="togglePassVis()" class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors">
                                <i id="passEyeIcon" class="fas fa-eye-slash text-sm"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Login Button -->
                    <button onclick="handleLogin()" class="w-full py-4 bg-[#3b7dd8] hover:bg-[#2e6bc4] text-white font-bold rounded-xl shadow-lg shadow-blue-500/25 transition-all hover:shadow-blue-500/40 active:scale-[0.98] text-base tracking-wide">
                        Login
                    </button>
                </div>

                <!-- Forget Password -->
                <p class="text-center mt-5">
                    <a href="#" class="text-[#3b7dd8] text-sm font-semibold hover:underline">Forget Password?</a>
                </p>
            </div>
        </div>
    </div>

    <!-- ================= APP SHELL ================= -->
    <div id="appShell" class="hidden flex h-screen">
        <!-- Sidebar -->
        <aside class="w-[60px] md:w-72 bg-slate-950 text-slate-400 flex flex-col h-full shrink-0 shadow-2xl z-20 transition-all duration-300">
            <div class="p-3 md:p-8 border-b border-slate-900 flex items-center justify-center md:justify-start gap-3">
                <div class="w-8 h-8 bg-brand-600 rounded-xl text-white flex items-center justify-center font-black text-sm shrink-0">G</div>
                <span class="text-white font-bold tracking-widest text-xs uppercase hidden md:inline">Enterprise Core</span>
            </div>
            <nav class="flex-1 overflow-y-auto py-6 px-2 md:px-4 space-y-1" id="mainNav"></nav>
            <div class="p-2 md:p-4 mx-1 md:mx-4 mb-2">
                <button onclick="handleLogout()" class="w-full py-3 text-slate-500 hover:text-red-400 font-bold text-xs uppercase tracking-widest transition-colors rounded-2xl hover:bg-red-500/10 flex items-center justify-center md:justify-start md:px-4">
                    <i class="fas fa-arrow-right-from-bracket md:mr-2"></i> <span class="hidden md:inline">Logout</span>
                </button>
            </div>
            <div class="p-2 md:p-5 bg-slate-900/40 m-1 md:m-4 mt-0 rounded-xl md:rounded-3xl border border-slate-800">
                <div class="flex items-center justify-center md:justify-start gap-3">
                    <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse shrink-0"></div>
                    <span class="text-[10px] font-black text-slate-300 uppercase tracking-wider hidden md:inline">Lumina AI Online</span>
                </div>
                <p class="text-[10px] text-slate-600 mt-1 pl-5 hidden md:block">13 modules synced</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col relative overflow-hidden">
            <header class="h-20 bg-white/80 backdrop-blur-xl border-b border-slate-100 flex items-center justify-between px-10 shrink-0 z-10">
                <div class="flex flex-col">
                    <h2 id="viewTitle" class="text-xl font-black text-slate-800 tracking-tight">Dashboard</h2>
                    <span id="roleLabel" class="text-[10px] text-brand-600 font-black uppercase tracking-[0.2em]">Super Admin</span>
                </div>
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <button onclick="toggleNotif()" class="w-11 h-11 bg-slate-100 rounded-2xl flex items-center justify-center text-slate-500 hover:bg-slate-200 transition-colors">
                            <i class="fas fa-bell text-sm"></i>
                        </button>
                        <span class="notif-badge" id="notifCount">5</span>
                    </div>
                    <button onclick="toggleAI()" class="px-5 py-2.5 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-brand-600 transition-all">
                        <i class="fas fa-brain mr-2"></i> Lumina
                    </button>
                    <div class="h-8 w-px bg-slate-200"></div>
                    <div class="flex items-center gap-3 cursor-pointer group" onclick="toggleProfile()">
                        <img id="userAvatar" src="https://ui-avatars.com/api/?name=Admin&background=4f46e5&color=fff&bold=true" class="w-10 h-10 rounded-2xl shadow-lg group-hover:shadow-xl transition-shadow">
                        <div class="hidden md:block">
                            <p id="userName" class="text-sm font-bold text-slate-700">Administrator</p>
                            <p id="userRoleSmall" class="text-[10px] text-slate-400 font-medium">Super Admin</p>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Notification Panel -->
            <div id="notifPanel" class="absolute right-48 top-20 w-96 bg-white rounded-3xl shadow-2xl border border-slate-100 z-40 hidden animate-card">
                <div class="p-6 border-b border-slate-100 flex justify-between items-center">
                    <h4 class="font-black text-sm">Notifications</h4>
                    <button class="text-[10px] text-brand-600 font-bold uppercase" onclick="clearNotifs()">Mark all read</button>
                </div>
                <div class="p-4 space-y-2 max-h-80 overflow-y-auto" id="notifList">
                    <div class="p-4 bg-brand-50 rounded-2xl border-l-4 border-brand-500"><p class="text-sm font-bold text-slate-700">New enrollment request</p><p class="text-xs text-slate-500 mt-1">3 minutes ago</p></div>
                    <div class="p-4 bg-amber-50 rounded-2xl border-l-4 border-amber-500"><p class="text-sm font-bold text-slate-700">Fee payment overdue — 12 students</p><p class="text-xs text-slate-500 mt-1">28 minutes ago</p></div>
                    <div class="p-4 bg-emerald-50 rounded-2xl border-l-4 border-emerald-500"><p class="text-sm font-bold text-slate-700">Semester report cards generated</p><p class="text-xs text-slate-500 mt-1">1 hour ago</p></div>
                    <div class="p-4 bg-sky-50 rounded-2xl border-l-4 border-sky-500"><p class="text-sm font-bold text-slate-700">Library inventory sync complete</p><p class="text-xs text-slate-500 mt-1">2 hours ago</p></div>
                    <div class="p-4 bg-rose-50 rounded-2xl border-l-4 border-rose-500"><p class="text-sm font-bold text-slate-700">Bus #7 maintenance alert</p><p class="text-xs text-slate-500 mt-1">4 hours ago</p></div>
                </div>
            </div>

            <!-- View Container -->
            <div id="viewContainer" class="flex-1 overflow-y-auto p-10"></div>
        </main>

        <!-- ================= LUMINA AI PANEL ================= -->
        <div id="aiPanel" class="fixed right-0 top-0 bottom-0 w-[450px] glass border-l translate-x-full transition-transform duration-500 z-50 shadow-2xl flex flex-col">
            <div class="p-8 bg-slate-950 text-white flex justify-between items-center">
                <h3 class="font-black text-xs uppercase tracking-[0.3em]"><i class="fas fa-microchip mr-3 text-indigo-400"></i> Lumina Core</h3>
                <button onclick="toggleAI()" class="w-8 h-8 rounded-xl bg-slate-800 hover:bg-slate-700 flex items-center justify-center transition-colors"><i class="fas fa-times text-xs"></i></button>
            </div>
            <div class="flex-1 p-6 space-y-4 overflow-y-auto" id="chatWindow">
                <div class="p-5 bg-brand-600 text-white rounded-3xl rounded-tl-lg text-sm font-medium shadow-xl leading-relaxed">
                    <p class="font-black text-xs uppercase tracking-widest mb-2 opacity-70">Lumina AI</p>
                    Institutional Intelligence Active. I am monitoring all core modules in real-time. Ask me about grades, finance, attendance, transport, inventory, or any operational metric.
                </div>
            </div>
            <div class="p-6 bg-white border-t">
                <div class="flex gap-2">
                    <input id="aiChatInput" type="text" placeholder="Ask Lumina anything..." class="flex-1 p-4 bg-slate-100 border-none rounded-2xl font-bold text-sm outline-none focus:ring-2 focus:ring-brand-500 transition-all" onkeypress="if(event.key==='Enter') sendToLumina()">
                    <button onclick="sendToLumina()" class="w-12 h-12 bg-brand-600 hover:bg-brand-500 text-white rounded-2xl flex items-center justify-center transition-colors shrink-0"><i class="fas fa-paper-plane text-sm"></i></button>
                </div>
                <div class="flex gap-2 mt-3 flex-wrap">
                    <button onclick="quickAsk('enrollment stats')" class="px-3 py-1.5 bg-slate-100 rounded-full text-[10px] font-bold text-slate-600 hover:bg-brand-100 hover:text-brand-700 transition-colors">Enrollment Stats</button>
                    <button onclick="quickAsk('fee overview')" class="px-3 py-1.5 bg-slate-100 rounded-full text-[10px] font-bold text-slate-600 hover:bg-brand-100 hover:text-brand-700 transition-colors">Fee Overview</button>
                    <button onclick="quickAsk('top performers')" class="px-3 py-1.5 bg-slate-100 rounded-full text-[10px] font-bold text-slate-600 hover:bg-brand-100 hover:text-brand-700 transition-colors">Top Performers</button>
                    <button onclick="quickAsk('attendance today')" class="px-3 py-1.5 bg-slate-100 rounded-full text-[10px] font-bold text-slate-600 hover:bg-brand-100 hover:text-brand-700 transition-colors">Attendance</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= JAVASCRIPT ENGINE ================= -->
    <script>
        // ---- PORTAL DEFINITIONS ----
        const PORTALS = [
            { id: 'dash',      label: 'Dashboard',          icon: 'fa-chart-tree-map',     roles: ['SUPER_ADMIN','SCHOOL_ADMIN','TEACHER','PARENT','STUDENT'] },
            { id: 'school',    label: 'School Management',  icon: 'fa-building-columns',   roles: ['SUPER_ADMIN','SCHOOL_ADMIN'] },
            { id: 'teacher',   label: 'Academic Desk',      icon: 'fa-chalkboard-user',    roles: ['SUPER_ADMIN','SCHOOL_ADMIN','TEACHER'] },
            { id: 'exams',     label: 'Assessment Engine',  icon: 'fa-file-circle-check',  roles: ['SUPER_ADMIN','SCHOOL_ADMIN','TEACHER','STUDENT'] },
            { id: 'parent',    label: 'Parent Portal',      icon: 'fa-people-roof',        roles: ['SUPER_ADMIN','SCHOOL_ADMIN','PARENT'] },
            { id: 'finance',   label: 'Finance Hub',        icon: 'fa-vault',              roles: ['SUPER_ADMIN','SCHOOL_ADMIN'] },
            { id: 'library',   label: 'Library Core',       icon: 'fa-book-open-reader',   roles: ['SUPER_ADMIN','SCHOOL_ADMIN','TEACHER','STUDENT'] },
            { id: 'transport', label: 'Fleet Sync',         icon: 'fa-truck-fast',         roles: ['SUPER_ADMIN','SCHOOL_ADMIN'] },
            { id: 'inventory', label: 'Stock Logic',        icon: 'fa-warehouse',          roles: ['SUPER_ADMIN','SCHOOL_ADMIN'] },
            { id: 'api',       label: 'API Gateway',        icon: 'fa-code-branch',        roles: ['SUPER_ADMIN'] }
        ];

        let role = 'SUPER_ADMIN';
        let charts = {};

        const ROLE_NAMES = { SUPER_ADMIN: 'Super Administrator', SCHOOL_ADMIN: 'School Administrator', TEACHER: 'Faculty Member', PARENT: 'Parent Guardian', STUDENT: 'Student' };
        const ROLE_AVATARS = { SUPER_ADMIN: 'Admin+Core', SCHOOL_ADMIN: 'School+Admin', TEACHER: 'Prof+Smith', PARENT: 'Jane+Doe', STUDENT: 'Alex+S' };

        // ---- AUTH ----
        function togglePassVis() {
            const input = document.getElementById('loginPass');
            const icon = document.getElementById('passEyeIcon');
            if (input.type === 'password') { input.type = 'text'; icon.classList.replace('fa-eye-slash','fa-eye'); }
            else { input.type = 'password'; icon.classList.replace('fa-eye','fa-eye-slash'); }
        }

        function handleLogin() {
            role = document.getElementById('loginRole').value;
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('appShell').classList.remove('hidden');
            document.getElementById('appShell').classList.add('flex');
            document.getElementById('roleLabel').textContent = ROLE_NAMES[role] || role.replace('_', ' ');
            document.getElementById('userRoleSmall').textContent = ROLE_NAMES[role] || role;
            document.getElementById('userName').textContent = role === 'SUPER_ADMIN' ? 'Administrator' : role === 'TEACHER' ? 'Prof. Smith' : role === 'PARENT' ? 'Jane Doe' : role === 'STUDENT' ? 'Alex Sterling' : 'School Admin';
            document.getElementById('userAvatar').src = `https://ui-avatars.com/api/?name=${ROLE_AVATARS[role]}&background=4f46e5&color=fff&bold=true`;
            renderSidebar();
            navigate('dash', 'Dashboard');
        }

        function handleLogout() {
            document.getElementById('appShell').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            Object.values(charts).forEach(c => c.destroy && c.destroy());
            charts = {};
        }

        // ---- SIDEBAR ----
        function renderSidebar() {
            const nav = document.getElementById('mainNav');
            const visiblePortals = PORTALS.filter(p => p.roles.includes(role));
            nav.innerHTML = visiblePortals.map(p => `
                <a href="#" onclick="event.preventDefault(); navigate('${p.id}', '${p.label}')" id="link-${p.id}"
                   class="nav-hover flex items-center justify-center md:justify-start gap-4 px-2 md:px-5 py-3.5 rounded-2xl transition-all text-sm font-semibold" title="${p.label}">
                    <i class="fas ${p.icon} w-5 text-center text-xs opacity-60 shrink-0"></i>
                    <span class="hidden md:inline">${p.label}</span>
                </a>
            `).join('');
        }

        // ---- NAVIGATION ----
        function navigate(id, label) {
            document.getElementById('viewTitle').textContent = label;
            document.querySelectorAll('nav a').forEach(a => a.classList.remove('sidebar-active'));
            document.getElementById('link-'+id)?.classList.add('sidebar-active');

            Object.values(charts).forEach(c => c.destroy && c.destroy());
            charts = {};

            const c = document.getElementById('viewContainer');
            const views = { dash: renderDashboard, school: renderSchoolAdmin, parent: renderParentPortal, finance: renderFinance, teacher: renderTeacher, library: renderLibrary, transport: renderTransport, inventory: renderInventory, exams: renderExams, api: renderAPI };
            (views[id] || (() => renderPlaceholder(c, label)))(c);
        }

        // ---- UI HELPERS ----
        function toggleAI() { document.getElementById('aiPanel').classList.toggle('translate-x-full'); }
        function toggleNotif() { document.getElementById('notifPanel').classList.toggle('hidden'); }
        function toggleProfile() {}
        function clearNotifs() { document.getElementById('notifCount').style.display = 'none'; document.getElementById('notifList').innerHTML = '<p class="text-center text-slate-400 text-sm py-8">All caught up!</p>'; }

        function statCard(label, value, icon, color, trend, trendDir) {
            const trendColor = trendDir === 'up' ? 'text-emerald-500' : trendDir === 'down' ? 'text-red-500' : 'text-slate-400';
            const trendIcon = trendDir === 'up' ? 'fa-arrow-trend-up' : trendDir === 'down' ? 'fa-arrow-trend-down' : 'fa-minus';
            return `<div class="card p-7">
                <div class="flex items-start justify-between mb-4">
                    <div class="stat-icon bg-${color}-100 text-${color}-600"><i class="fas ${icon}"></i></div>
                    <span class="flex items-center gap-1 ${trendColor} text-xs font-bold"><i class="fas ${trendIcon}"></i> ${trend}</span>
                </div>
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">${label}</p>
                <h4 class="text-3xl font-black text-slate-800 animate-count">${value}</h4>
            </div>`;
        }

        function makeChart(id, config) {
            setTimeout(() => {
                const el = document.getElementById(id);
                if (el) charts[id] = new Chart(el.getContext('2d'), config);
            }, 100);
        }

        // ===================================================================
        //  VIEW: DASHBOARD
        // ===================================================================
        function renderDashboard(c) {
            // ---- SUPER ADMIN DASHBOARD (matches design spec) ----
            if (role === 'SUPER_ADMIN') {
                c.innerHTML = `<div class="animate-view space-y-6">
                    <!-- Greeting -->
                    <div class="flex items-center justify-between">
                        <h3 class="text-2xl font-black text-slate-800 tracking-tight"><i class="fas fa-solar-system mr-2 text-brand-600"></i>System Status</h3>
                        <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                    </div>

                    <!-- Colored Stat Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-5">
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#3b82f6,#2563eb);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Families</p>
                            <h3 class="text-4xl font-black leading-none">124</h3>
                            <i class="fas fa-people-roof absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#10b981,#059669);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Teachers</p>
                            <h3 class="text-4xl font-black leading-none">15,430</h3>
                            <i class="fas fa-chalkboard-user absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#6366f1,#4338ca);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Students</p>
                            <h3 class="text-4xl font-black leading-none">23,300</h3>
                            <i class="fas fa-user-graduate absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#ef4444,#dc2626);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Revenue</p>
                            <h3 class="text-4xl font-black leading-none">$23,800</h3>
                            <i class="fas fa-sack-dollar absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                    </div>

                    <!-- Platform Overview + Region Schools -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="card p-8 lg:col-span-2">
                            <div class="flex justify-between items-center mb-6">
                                <h4 class="font-black text-base text-slate-800">Platform Overview</h4>
                                <div class="flex gap-4">
                                    <span class="flex items-center gap-1.5 text-[11px] font-bold text-slate-500"><span class="w-2.5 h-2.5 rounded-full bg-indigo-500 inline-block"></span> GMS</span>
                                    <span class="flex items-center gap-1.5 text-[11px] font-bold text-slate-500"><span class="w-2.5 h-2.5 rounded-full bg-emerald-500 inline-block"></span> SMS</span>
                                    <span class="flex items-center gap-1.5 text-[11px] font-bold text-slate-500"><span class="w-2.5 h-2.5 rounded-full bg-amber-500 inline-block"></span> DMs</span>
                                </div>
                            </div>
                            <canvas id="platformChart" height="140"></canvas>
                        </div>
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="font-black text-base text-slate-800">Region Schools</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <canvas id="regionChart" height="200"></canvas>
                        </div>
                    </div>

                    <!-- Schools List + Revenue Breakdown -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="card p-8 lg:col-span-2">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800">Schools List</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="grid grid-cols-12 px-4 py-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">
                                <span class="col-span-5">School / Name</span><span class="col-span-3">Location</span><span class="col-span-2 text-center">Status</span><span class="col-span-2 text-right">Action</span>
                            </div>
                            <div class="space-y-2">
                                ${[
                                    { n:'Mapleton Academy', loc:'Southees', active:true },
                                    { n:'Crest Intl. Math', loc:'Someplace', active:true },
                                    { n:'Everts Richmond', loc:'Starsby', active:false },
                                    { n:'Mount Crestview', loc:'Townplace', active:true },
                                    { n:'Grand Oakhill Prep', loc:'Northbridge', active:true }
                                ].map(s => `
                                    <div class="grid grid-cols-12 items-center px-4 py-3.5 bg-slate-50/60 rounded-2xl hover:bg-brand-50 transition-colors cursor-pointer group">
                                        <div class="col-span-5 flex items-center gap-3">
                                            <input type="checkbox" class="w-4 h-4 rounded accent-brand-600 shrink-0">
                                            <span class="text-sm font-bold text-slate-700 truncate">${s.n}</span>
                                        </div>
                                        <span class="col-span-3 text-sm text-slate-500 font-medium">${s.loc}</span>
                                        <div class="col-span-2 flex justify-center"><span class="w-2.5 h-2.5 rounded-full ${s.active ? 'bg-emerald-500 shadow-emerald-500/40 shadow-sm' : 'bg-slate-300'}"></span></div>
                                        <div class="col-span-2 flex justify-end">
                                            <img src="https://ui-avatars.com/api/?name=${s.n.replace(/ /g,'+')}&background=e2e8f0&color=475569&bold=true&size=28" class="w-7 h-7 rounded-full ring-2 ring-white">
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="font-black text-base text-slate-800">Revenue Breakdown</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="flex justify-center"><canvas id="revenueBreakdownChart" height="180" style="max-height:180px"></canvas></div>
                            <div class="mt-5 space-y-3">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2.5"><span class="w-3 h-3 rounded-full bg-indigo-500 shrink-0"></span><span class="text-xs font-bold text-slate-600">Tuition Fees</span></div>
                                    <span class="text-sm font-black text-slate-800">86%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2.5"><span class="w-3 h-3 rounded-full bg-emerald-500 shrink-0"></span><span class="text-xs font-bold text-slate-600">Govt Grants</span></div>
                                    <span class="text-sm font-black text-slate-800">71%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2.5"><span class="w-3 h-3 rounded-full bg-amber-500 shrink-0"></span><span class="text-xs font-bold text-slate-600">Other Income</span></div>
                                    <span class="text-sm font-black text-slate-800">67%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;

                // Platform Overview — multi-line chart
                makeChart('platformChart', {
                    type: 'line',
                    data: {
                        labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
                        datasets: [
                            { label: 'GMS', data: [30,48,38,55,42,65,58,74,68,82,78,92], borderColor: '#4f46e5', backgroundColor: 'rgba(79,70,229,0.06)', fill: true, tension: 0.4, pointRadius: 4, pointBackgroundColor: '#4f46e5', pointBorderColor: '#fff', pointBorderWidth: 2, borderWidth: 2.5 },
                            { label: 'SMS', data: [22,32,28,38,34,44,38,52,48,58,54,64], borderColor: '#10b981', backgroundColor: 'transparent', fill: false, tension: 0.4, pointRadius: 4, pointBackgroundColor: '#10b981', pointBorderColor: '#fff', pointBorderWidth: 2, borderWidth: 2.5 },
                            { label: 'DMs', data: [12,18,22,20,28,24,32,30,38,35,42,40], borderColor: '#f59e0b', backgroundColor: 'transparent', fill: false, tension: 0.4, pointRadius: 4, pointBackgroundColor: '#f59e0b', pointBorderColor: '#fff', pointBorderWidth: 2, borderWidth: 2.5 }
                        ]
                    },
                    options: { responsive: true, interaction: { intersect: false, mode: 'index' }, plugins: { legend: { display: false }, tooltip: { backgroundColor: '#1e293b', titleFont: { weight: 700 }, bodyFont: { weight: 600 }, cornerRadius: 10, padding: 12 } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } }, y: { grid: { color: '#f1f5f9' }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } } } }
                });

                // Region Schools — donut chart
                makeChart('regionChart', {
                    type: 'doughnut',
                    data: {
                        labels: ['North','South','East','West','Central'],
                        datasets: [{ data: [28,22,20,18,12], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#10b981','#ec4899'], borderWidth: 0, hoverOffset: 6 }]
                    },
                    options: { responsive: true, cutout: '62%', plugins: { legend: { position: 'bottom', labels: { padding: 14, usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 }, color: '#475569' } } } }
                });

                // Revenue Breakdown — donut chart
                makeChart('revenueBreakdownChart', {
                    type: 'doughnut',
                    data: {
                        labels: ['Tuition Fees','Govt Grants','Other Income'],
                        datasets: [{ data: [86,71,67], backgroundColor: ['#4f46e5','#10b981','#f59e0b'], borderWidth: 0, hoverOffset: 6 }]
                    },
                    options: { responsive: true, cutout: '70%', plugins: { legend: { display: false } } }
                });
                return;
            }

            // ---- STUDENT DASHBOARD ----
            if (role === 'STUDENT') {
                c.innerHTML = `<div class="animate-view space-y-6">
                    <!-- Header -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <h3 class="text-2xl font-black text-slate-800 tracking-tight"><i class="fas fa-user-graduate mr-2 text-brand-600"></i>Tenderin</h3>
                            <span class="text-slate-300 text-xl font-light">›</span>
                            <select class="px-4 py-2.5 bg-white border-2 border-slate-200 rounded-xl font-bold text-slate-700 outline-none focus:border-brand-500 transition-colors text-sm cursor-pointer shadow-sm">
                                <option>Harriet</option>
                                <option>Alex Sterling</option>
                            </select>
                        </div>
                        <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                    </div>

                    <!-- 3 Colored Stat Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#3b82f6,#2563eb);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Attendance</p>
                            <h3 class="text-5xl font-black leading-none">92%</h3>
                            <i class="fas fa-calendar-check absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#10b981,#059669);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Grades</p>
                            <h3 class="text-5xl font-black leading-none">85%</h3>
                            <i class="fas fa-graduation-cap absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                        <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#f59e0b,#d97706);">
                            <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Fee Status</p>
                            <h3 class="text-5xl font-black leading-none">Paid</h3>
                            <i class="fas fa-wallet absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                        </div>
                    </div>

                    <!-- Recent Results + Upcoming Lessons -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Recent Results -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800">Recent Results</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="grid grid-cols-12 px-4 py-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 border-b border-slate-100">
                                <span class="col-span-1"></span>
                                <span class="col-span-5">Subject</span>
                                <span class="col-span-3 text-center">Grade</span>
                                <span class="col-span-3 text-right">Score</span>
                            </div>
                            <div class="space-y-1">
                                ${[
                                    { subj:'Grade 7 - Math', grade:'A', score:'93.9%', gc:'indigo' },
                                    { subj:'Grade 7 - Math', grade:'B+', score:'88.0%', gc:'emerald' },
                                    { subj:'Grade 7 - Literature', grade:'A-', score:'91.2%', gc:'amber' }
                                ].map(r => `
                                    <div class="grid grid-cols-12 items-center px-4 py-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer">
                                        <div class="col-span-1 flex items-center">
                                            <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        </div>
                                        <span class="col-span-5 text-sm font-bold text-slate-700">${r.subj}</span>
                                        <span class="col-span-3 text-center text-sm font-black text-${r.gc}-600">${r.grade}</span>
                                        <span class="col-span-3 text-right text-sm font-bold text-slate-700">${r.score}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Upcoming Lessons -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800">Upcoming Lessons</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="space-y-3">
                                ${[
                                    { t:'Colourful Reactions', sub:'Chemistry', time:'5:10', col:'indigo', icon:'fa-flask', badge:'Persuading' },
                                    { t:'Creativity', sub:'Art & Design', time:'1:00', col:'amber', icon:'fa-palette', badge:'Discussions' },
                                    { t:'Expensory Process', sub:'Business Studies', time:'5:10', col:'emerald', icon:'fa-chart-pie', badge:'Discussions' }
                                ].map(l => `
                                    <div class="flex items-center justify-between p-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer group">
                                        <div class="flex items-center gap-3">
                                            <span class="text-xs font-bold text-slate-400 w-10">${l.time}</span>
                                            <div class="w-8 h-8 bg-${l.col}-100 text-${l.col}-600 rounded-lg flex items-center justify-center text-xs"><i class="fas ${l.icon}"></i></div>
                                            <div>
                                                <p class="text-sm font-bold text-slate-700">${l.t}</p>
                                                <p class="text-[11px] text-slate-400 font-medium">${l.sub}</p>
                                            </div>
                                        </div>
                                        <span class="badge bg-${l.col}-100 text-${l.col}-700">${l.badge}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- Announcements + Class Resources -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Announcements -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800"><i class="fas fa-bullhorn mr-2 text-red-400"></i>Announcements</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="space-y-3">
                                ${[
                                    { t:'Science Fair Registration', detail:'Desert Lessons', done:true },
                                    { t:'Practice Reminders', detail:'$1.00/ms', done:true },
                                    { t:'Scholarship Applications', detail:'$1.00/ms', done:true }
                                ].map(a => `
                                    <div class="flex items-center justify-between p-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer">
                                        <div class="flex items-center gap-3">
                                            <div class="w-5 h-5 bg-blue-500 rounded-md flex items-center justify-center shrink-0"><i class="fas fa-check text-white text-[9px]"></i></div>
                                            <span class="text-sm font-bold text-slate-700">${a.t}</span>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <span class="text-xs font-bold text-slate-400">${a.detail}</span>
                                            <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Class Resources -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800"><i class="fas fa-book mr-2 text-brand-500"></i>Class Resources</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                ${[
                                    { t:'Mathematics Workbook', sub:'Grade 7 — Chapter 5-8', col:'indigo', icon:'fa-calculator' },
                                    { t:'English Literature', sub:'Poetry Anthology', col:'emerald', icon:'fa-feather-pointed' },
                                    { t:'Science Lab Manual', sub:'Physics Experiments', col:'amber', icon:'fa-flask' },
                                    { t:'History Notes', sub:'World War II', col:'rose', icon:'fa-landmark' }
                                ].map(m => `
                                    <div class="p-4 bg-slate-50 rounded-2xl hover:bg-white hover:shadow-md transition-all border border-transparent hover:border-slate-100 cursor-pointer group">
                                        <div class="w-full h-20 bg-gradient-to-br from-${m.col}-100 to-${m.col}-200 rounded-xl flex items-center justify-center mb-3">
                                            <i class="fas ${m.icon} text-2xl text-${m.col}-500"></i>
                                        </div>
                                        <h5 class="font-bold text-slate-800 text-xs mb-0.5 truncate">${m.t}</h5>
                                        <p class="text-[10px] text-slate-400 font-medium truncate">${m.sub}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>`;
                return;
            }

            // ---- DEFAULT DASHBOARD (non-Super-Admin roles) ----
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="flex items-end justify-between mb-2">
                    <div>
                        <h3 class="text-3xl font-black text-slate-800 tracking-tight">Good ${new Date().getHours() < 12 ? 'Morning' : new Date().getHours() < 18 ? 'Afternoon' : 'Evening'}, ${role === 'TEACHER' ? 'Prof. Smith' : role === 'PARENT' ? 'Jane' : role === 'STUDENT' ? 'Alex' : 'Admin'}</h3>
                        <p class="text-slate-500 font-medium mt-1">Here's what's happening across Global School System today.</p>
                    </div>
                    <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
                    ${statCard('Total Students','12,847','fa-user-graduate','indigo','+3.2%','up')}
                    ${statCard('Active Staff','1,204','fa-users','emerald','+1.8%','up')}
                    ${statCard('Term Revenue','$2.4M','fa-sack-dollar','amber','+12.5%','up')}
                    ${statCard('Avg Attendance','94.6%','fa-calendar-check','sky','-0.4%','down')}
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="font-black text-sm text-slate-700">Enrollment Trend</h4>
                            <div class="flex gap-2">
                                <span class="badge bg-brand-100 text-brand-700">This Year</span>
                                <span class="badge bg-slate-100 text-slate-500">Last Year</span>
                            </div>
                        </div>
                        <canvas id="enrollChart" height="140"></canvas>
                    </div>
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Department Split</h4>
                        <canvas id="deptChart" height="200"></canvas>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Recent Activity</h4>
                        <div class="space-y-3">
                            ${[
                                { t:'Enrollment batch #482 processed', s:'3 min ago', i:'fa-user-plus', col:'indigo' },
                                { t:'Finance report Q3 generated', s:'18 min ago', i:'fa-file-invoice-dollar', col:'emerald' },
                                { t:'Library: 45 new books cataloged', s:'1 hr ago', i:'fa-book', col:'amber' },
                                { t:'Bus Route #12 updated', s:'2 hr ago', i:'fa-bus', col:'sky' },
                                { t:'System backup completed', s:'4 hr ago', i:'fa-shield-check', col:'slate' }
                            ].map(a => `
                                <div class="table-row">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 bg-${a.col}-100 text-${a.col}-600 rounded-xl flex items-center justify-center text-sm"><i class="fas ${a.i}"></i></div>
                                        <div><p class="text-sm font-bold text-slate-700">${a.t}</p><p class="text-xs text-slate-400">${a.s}</p></div>
                                    </div>
                                    <i class="fas fa-chevron-right text-slate-300 text-xs"></i>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Quick Actions</h4>
                        <div class="grid grid-cols-2 gap-4">
                            ${[
                                { l:'Add Student', i:'fa-user-plus', col:'indigo' },
                                { l:'Record Payment', i:'fa-credit-card', col:'emerald' },
                                { l:'Schedule Exam', i:'fa-calendar-plus', col:'amber' },
                                { l:'Send Notice', i:'fa-envelope', col:'sky' },
                                { l:'Generate Report', i:'fa-chart-bar', col:'violet' },
                                { l:'System Settings', i:'fa-gear', col:'slate' }
                            ].map(a => `
                                <button class="p-5 bg-${a.col}-50 hover:bg-${a.col}-100 rounded-2xl text-left transition-colors group">
                                    <i class="fas ${a.i} text-${a.col}-500 mb-2 text-lg group-hover:scale-110 transition-transform inline-block"></i>
                                    <p class="text-sm font-bold text-slate-700">${a.l}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-slate-950 to-indigo-950 p-10 rounded-[3rem] text-white relative overflow-hidden">
                    <div class="relative z-10 flex justify-between items-center">
                        <div>
                            <p class="text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-2">Lumina AI Insight</p>
                            <h3 class="text-2xl font-black mb-2">Attendance dipped 1.2% this week</h3>
                            <p class="text-indigo-300 max-w-lg text-sm leading-relaxed">Lumina detected irregular patterns in Grades 7-9. Recommended action: review flu season protocols and send parent notifications.</p>
                        </div>
                        <button onclick="toggleAI()" class="bg-white text-slate-950 px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest hover:scale-105 transition-transform shrink-0">Investigate</button>
                    </div>
                    <i class="fas fa-brain absolute -right-16 -bottom-16 text-[18rem] text-white/[0.03]"></i>
                </div>
            </div>`;

            // Enrollment chart
            makeChart('enrollChart', {
                type: 'line',
                data: { labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
                    datasets: [
                        { label: 'This Year', data: [980,1050,1120,1180,1250,1340,1280,1420,1510,1580,1620,1680], borderColor: '#4f46e5', backgroundColor: 'rgba(79,70,229,0.08)', fill: true, tension: 0.4, pointRadius: 0, borderWidth: 3 },
                        { label: 'Last Year', data: [900,940,1000,1020,1080,1140,1100,1200,1280,1340,1380,1420], borderColor: '#cbd5e1', backgroundColor: 'transparent', borderDash: [6,4], tension: 0.4, pointRadius: 0, borderWidth: 2 }
                    ]
                },
                options: { responsive: true, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } }, y: { grid: { color: '#f1f5f9' }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } } } }
            });
            // Department chart
            makeChart('deptChart', {
                type: 'doughnut',
                data: { labels: ['Science','Arts','Commerce','Technology','Sports'], datasets: [{ data: [35,20,25,15,5], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#10b981','#ec4899'], borderWidth: 0 }] },
                options: { responsive: true, cutout: '70%', plugins: { legend: { position: 'bottom', labels: { padding: 16, usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } } }
            });
        }

        // ===================================================================
        //  VIEW: SCHOOL MANAGEMENT
        // ===================================================================
        function renderSchoolAdmin(c) {
            c.innerHTML = `<div class="animate-view space-y-6">
                <!-- School Name Header -->
                <div class="flex items-center justify-between">
                    <h3 class="text-2xl font-black text-slate-800 tracking-tight"><i class="fas fa-building-columns mr-2 text-brand-600"></i>Stobet Suiam</h3>
                    <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                </div>

                <!-- Colored Stat Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-5">
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#ef4444,#dc2626);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Students</p>
                        <h3 class="text-4xl font-black leading-none">850</h3>
                        <i class="fas fa-user-graduate absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#10b981,#059669);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Teachers</p>
                        <h3 class="text-4xl font-black leading-none">45</h3>
                        <i class="fas fa-chalkboard-user absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#3b82f6,#2563eb);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Parents</p>
                        <h3 class="text-4xl font-black leading-none">620</h3>
                        <i class="fas fa-people-roof absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#f59e0b,#d97706);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Pending Fees</p>
                        <h3 class="text-4xl font-black leading-none">$12,500</h3>
                        <span class="absolute top-4 right-4 text-xs font-bold bg-white/20 px-2 py-0.5 rounded-full">-5%</span>
                        <i class="fas fa-sack-dollar absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                </div>

                <!-- Attendance Overview + Recent Parents -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="font-black text-base text-slate-800">Attendance Overview</h4>
                            <div class="flex gap-3">
                                <span class="flex items-center gap-1.5 text-[11px] font-bold text-slate-500"><span class="w-2.5 h-2.5 rounded-full bg-indigo-500 inline-block"></span> Present</span>
                                <span class="flex items-center gap-1.5 text-[11px] font-bold text-slate-500"><span class="w-2.5 h-2.5 rounded-full bg-amber-400 inline-block"></span> Absent</span>
                            </div>
                        </div>
                        <canvas id="schoolAttendanceChart" height="140"></canvas>
                    </div>
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-black text-base text-slate-800">Recent Parents</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <canvas id="recentParentsChart" height="200"></canvas>
                    </div>
                </div>

                <!-- Fee Collection + Recent Admissions -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="font-black text-base text-slate-800">Fee Collection</h4>
                            <div class="flex gap-2">
                                <span class="badge bg-brand-100 text-brand-700">This Year</span>
                                <span class="badge bg-slate-100 text-slate-500">Last Year</span>
                            </div>
                        </div>
                        <canvas id="feeCollectionChart" height="140"></canvas>
                    </div>
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800">Recent Admissions</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <div class="space-y-3">
                            ${[
                                { n:'Coral McKenzie', d:'Grade 8 — Science', t:'2 hrs ago', col:'indigo' },
                                { n:'Grant Williams', d:'Grade 10 — Arts', t:'5 hrs ago', col:'emerald' },
                                { n:'Israel Scholefield', d:'Grade 7 — Commerce', t:'1 day ago', col:'amber' },
                                { n:'Diana Foster', d:'Grade 9 — Technology', t:'1 day ago', col:'sky' },
                                { n:'Liam Patel', d:'Grade 11 — Science', t:'2 days ago', col:'rose' }
                            ].map(a => `
                                <div class="table-row">
                                    <div class="flex items-center gap-4">
                                        <img src="https://ui-avatars.com/api/?name=${a.n.replace(/ /g,'+')}&background=${a.col === 'indigo' ? 'eef2ff' : a.col === 'emerald' ? 'ecfdf5' : a.col === 'amber' ? 'fffbeb' : a.col === 'sky' ? 'f0f9ff' : 'fff1f2'}&color=${a.col === 'indigo' ? '4f46e5' : a.col === 'emerald' ? '059669' : a.col === 'amber' ? 'd97706' : a.col === 'sky' ? '0284c7' : 'e11d48'}&bold=true&size=36" class="w-9 h-9 rounded-xl">
                                        <div>
                                            <p class="text-sm font-bold text-slate-700">${a.n}</p>
                                            <p class="text-[11px] text-slate-400 font-medium">${a.d}</p>
                                        </div>
                                    </div>
                                    <span class="text-[10px] font-bold text-slate-400">${a.t}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <!-- Lumina Insight Banner -->
                <div class="bg-gradient-to-r from-slate-950 to-indigo-950 p-10 rounded-[3rem] text-white relative overflow-hidden">
                    <div class="relative z-10 flex justify-between items-center">
                        <div>
                            <p class="text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-2">Lumina School Insight</p>
                            <h3 class="text-2xl font-black mb-2">Fee collection is 92% complete</h3>
                            <p class="text-indigo-300 max-w-lg text-sm leading-relaxed">12 students have overdue balances totaling $8,400. Lumina recommends sending automated reminders to parents this week.</p>
                        </div>
                        <button onclick="toggleAI()" class="bg-white text-slate-950 px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest hover:scale-105 transition-transform shrink-0">View Details</button>
                    </div>
                    <i class="fas fa-school absolute -right-16 -bottom-16 text-[18rem] text-white/[0.03]"></i>
                </div>
            </div>`;

            // Attendance Overview — grouped bar chart
            makeChart('schoolAttendanceChart', {
                type: 'bar',
                data: {
                    labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
                    datasets: [
                        { label: 'Present', data: [780,790,810,800,820,805,790,830,825,840,835,842], backgroundColor: '#4f46e5', borderRadius: 6, barPercentage: 0.6 },
                        { label: 'Absent', data: [70,60,40,50,30,45,60,20,25,10,15,8], backgroundColor: '#fbbf24', borderRadius: 6, barPercentage: 0.6 }
                    ]
                },
                options: { responsive: true, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } }, y: { grid: { color: '#f1f5f9' }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } } } }
            });

            // Recent Parents — donut chart
            makeChart('recentParentsChart', {
                type: 'doughnut',
                data: {
                    labels: ['Active','New','Inactive','Pending'],
                    datasets: [{ data: [420,120,50,30], backgroundColor: ['#4f46e5','#10b981','#f59e0b','#ef4444'], borderWidth: 0, hoverOffset: 6 }]
                },
                options: { responsive: true, cutout: '62%', plugins: { legend: { position: 'bottom', labels: { padding: 14, usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 }, color: '#475569' } } } }
            });

            // Fee Collection — colorful bar chart
            makeChart('feeCollectionChart', {
                type: 'bar',
                data: {
                    labels: ['Dec','Jan','Feb','Mar','Apr','May','Jun'],
                    datasets: [
                        { label: 'This Year', data: [42000,38000,55000,48000,62000,58000,70000], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#10b981','#ec4899','#8b5cf6','#f97316'], borderRadius: 8, barPercentage: 0.55 },
                        { label: 'Last Year', data: [35000,32000,45000,40000,50000,48000,58000], backgroundColor: '#e2e8f0', borderRadius: 8, barPercentage: 0.55 }
                    ]
                },
                options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 }, color: '#94a3b8' } }, y: { grid: { color: '#f1f5f9' }, ticks: { callback: v => '$'+v/1000+'K', font: { weight: 700, size: 10 }, color: '#94a3b8' } } } }
            });
        }

        // ===================================================================
        //  VIEW: PARENT PORTAL
        // ===================================================================
        function renderParentPortal(c) {
            c.innerHTML = `<div class="animate-view space-y-6">
                <!-- Select Child Header -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <h3 class="text-2xl font-black text-slate-800 tracking-tight"><i class="fas fa-people-roof mr-2 text-brand-600"></i>Select Child</h3>
                        <select class="px-4 py-2.5 bg-white border-2 border-slate-200 rounded-xl font-bold text-slate-700 outline-none focus:border-brand-500 transition-colors text-sm cursor-pointer shadow-sm">
                            <option>Emily Johnson</option>
                            <option>Michael Johnson</option>
                        </select>
                    </div>
                    <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                </div>

                <!-- 3 Colored Stat Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#3b82f6,#2563eb);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Attendance</p>
                        <h3 class="text-5xl font-black leading-none">95%</h3>
                        <i class="fas fa-calendar-check absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#10b981,#059669);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Grades</p>
                        <h3 class="text-5xl font-black leading-none">B+</h3>
                        <p class="text-sm font-bold opacity-75 mt-1">Good</p>
                        <i class="fas fa-graduation-cap absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                    <div class="rounded-2xl p-6 text-white relative overflow-hidden shadow-lg" style="background:linear-gradient(135deg,#f59e0b,#d97706);">
                        <p class="text-[10px] font-black uppercase tracking-widest opacity-75 mb-1">Fee Balance</p>
                        <h3 class="text-5xl font-black leading-none">$200</h3>
                        <p class="text-sm font-bold opacity-75 mt-1">Due</p>
                        <i class="fas fa-wallet absolute right-4 bottom-3 text-5xl opacity-[0.12]"></i>
                    </div>
                </div>

                <!-- Recent Results + Upcoming Lessons -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Recent Results -->
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800">Recent Results</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <!-- Table Header -->
                        <div class="grid grid-cols-12 px-4 py-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 border-b border-slate-100">
                            <span class="col-span-4">Subject</span>
                            <span class="col-span-3 text-center">Grade</span>
                            <span class="col-span-3 text-center">Mark</span>
                            <span class="col-span-2 text-center">Status</span>
                        </div>
                        <div class="space-y-1">
                            ${[
                                { subj:'Math', grade:'B', mark:90, col:'indigo' },
                                { subj:'English', grade:'B-', mark:80, col:'emerald' },
                                { subj:'Science', grade:'A+', mark:80, col:'amber' }
                            ].map(r => \`
                                <div class="grid grid-cols-12 items-center px-4 py-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer">
                                    <div class="col-span-4 flex items-center gap-3">
                                        <div class="w-5 h-5 bg-brand-500 rounded-md flex items-center justify-center shrink-0"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        <span class="text-sm font-bold text-slate-700">\${r.subj}</span>
                                    </div>
                                    <span class="col-span-3 text-center text-sm font-black text-\${r.col}-600">\${r.grade}</span>
                                    <span class="col-span-3 text-center text-sm font-bold text-slate-700">\${r.mark}</span>
                                    <div class="col-span-2 flex justify-center">
                                        <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                    </div>
                                </div>
                            \`).join('')}
                        </div>
                    </div>

                    <!-- Upcoming Lessons -->
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800">Upcoming Lessons</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <div class="space-y-3">
                            ${[
                                { t:'Phonics Chapter 1', due:'Tomorrow', col:'indigo', icon:'fa-book-open' },
                                { t:'History Project', due:'Tomorrow', col:'amber', icon:'fa-landmark' },
                                { t:'Schooling', due:'Reasons', col:'emerald', icon:'fa-school' }
                            ].map(l => \`
                                <div class="flex items-center justify-between p-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer group">
                                    <div class="flex items-center gap-3">
                                        <div class="w-5 h-5 bg-\${l.col}-500 rounded-md flex items-center justify-center shrink-0"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        <div class="w-8 h-8 bg-\${l.col}-100 text-\${l.col}-600 rounded-lg flex items-center justify-center text-xs"><i class="fas \${l.icon}"></i></div>
                                        <span class="text-sm font-bold text-slate-700">\${l.t}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-xs font-bold text-slate-400">\${l.due}</span>
                                        <i class="fas fa-chevron-right text-[10px] text-slate-300 group-hover:text-brand-500 transition-colors"></i>
                                    </div>
                                </div>
                            \`).join('')}
                        </div>
                    </div>
                </div>

                <!-- Announcements + Study Materials -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Announcements -->
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800"><i class="fas fa-bullhorn mr-2 text-red-400"></i>Announcements</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <div class="space-y-3">
                            ${[
                                { t:'Study Materials', detail:'95 Done', done:true, col:'blue' },
                                { t:'Study Materials', detail:'95 Done', done:true, col:'blue' }
                            ].map(a => \`
                                <div class="flex items-center justify-between p-3.5 bg-slate-50/60 rounded-xl hover:bg-brand-50 transition-colors cursor-pointer">
                                    <div class="flex items-center gap-3">
                                        <div class="w-5 h-5 bg-\${a.col}-500 rounded-md flex items-center justify-center shrink-0"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        <span class="text-sm font-bold text-slate-700">\${a.t}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-xs font-bold text-slate-400">\${a.detail}</span>
                                        <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                    </div>
                                </div>
                            \`).join('')}
                        </div>
                    </div>

                    <!-- Study Materials -->
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800"><i class="fas fa-book mr-2 text-brand-500"></i>Study Materials</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            ${[
                                { t:'Mathematics Workbook', sub:'Grade 10 — Chapter 5-8', col:'indigo', icon:'fa-calculator' },
                                { t:'English Literature', sub:'Poetry Anthology', col:'emerald', icon:'fa-feather-pointed' },
                                { t:'Science Lab Manual', sub:'Physics Experiments', col:'amber', icon:'fa-flask' },
                                { t:'History Notes', sub:'World War II', col:'rose', icon:'fa-landmark' }
                            ].map(m => \`
                                <div class="p-4 bg-slate-50 rounded-2xl hover:bg-white hover:shadow-md transition-all border border-transparent hover:border-slate-100 cursor-pointer group">
                                    <div class="w-full h-20 bg-gradient-to-br from-\${m.col}-100 to-\${m.col}-200 rounded-xl flex items-center justify-center mb-3">
                                        <i class="fas \${m.icon} text-2xl text-\${m.col}-500"></i>
                                    </div>
                                    <h5 class="font-bold text-slate-800 text-xs mb-0.5 truncate">\${m.t}</h5>
                                    <p class="text-[10px] text-slate-400 font-medium truncate">\${m.sub}</p>
                                </div>
                            \`).join('')}
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // ===================================================================
        //  VIEW: FINANCE HUB
        // ===================================================================
        function renderFinance(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('Total Revenue','$2.4M','fa-sack-dollar','emerald','+12.5%','up')}
                    ${statCard('Outstanding Fees','$186K','fa-hourglass-half','amber','-8.2%','down')}
                    ${statCard('Expenses','$1.8M','fa-money-bill-transfer','red','On budget','up')}
                    ${statCard('Net Surplus','$620K','fa-piggy-bank','indigo','+22.1%','up')}
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Revenue vs Expenses</h4>
                        <canvas id="financeChart" height="130"></canvas>
                    </div>
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Budget Allocation</h4>
                        <canvas id="budgetChart" height="220"></canvas>
                    </div>
                </div>
                <div class="card p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h4 class="font-black text-sm text-slate-700">Recent Transactions</h4>
                        <button class="badge bg-brand-100 text-brand-700 hover:bg-brand-200 transition-colors cursor-pointer">Export CSV</button>
                    </div>
                    <div class="space-y-3">
                        ${[
                            { d:'Fee Payment — Sterling Family', a:'+$3,200', t:'Today', col:'emerald', i:'fa-arrow-down' },
                            { d:'Lab Equipment Purchase', a:'-$12,450', t:'Yesterday', col:'red', i:'fa-arrow-up' },
                            { d:'Govt Grant Received', a:'+$50,000', t:'Dec 14', col:'emerald', i:'fa-arrow-down' },
                            { d:'Staff Payroll — December', a:'-$284,000', t:'Dec 1', col:'red', i:'fa-arrow-up' },
                            { d:'Fee Collection Batch #96', a:'+$128,600', t:'Nov 28', col:'emerald', i:'fa-arrow-down' }
                        ].map(t => `
                            <div class="table-row">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-${t.col}-100 text-${t.col}-600 rounded-xl flex items-center justify-center"><i class="fas ${t.i} text-sm"></i></div>
                                    <div><p class="text-sm font-bold text-slate-700">${t.d}</p><p class="text-xs text-slate-400">${t.t}</p></div>
                                </div>
                                <span class="font-black text-sm ${t.col === 'emerald' ? 'text-emerald-600' : 'text-red-500'}">${t.a}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>`;

            makeChart('financeChart', {
                type: 'bar',
                data: { labels: ['Jul','Aug','Sep','Oct','Nov','Dec'], datasets: [
                    { label: 'Revenue', data: [380000,420000,395000,440000,460000,485000], backgroundColor: '#4f46e5', borderRadius: 8, barPercentage: 0.6 },
                    { label: 'Expenses', data: [290000,310000,305000,330000,340000,350000], backgroundColor: '#e2e8f0', borderRadius: 8, barPercentage: 0.6 }
                ] },
                options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 } } }, y: { grid: { color: '#f1f5f9' }, ticks: { callback: v => '$'+v/1000+'K', font: { weight: 700, size: 10 } } } } }
            });
            makeChart('budgetChart', {
                type: 'doughnut',
                data: { labels: ['Salaries','Infrastructure','Academics','Operations','Reserve'], datasets: [{ data: [45,20,18,12,5], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#10b981','#e2e8f0'], borderWidth: 0 }] },
                options: { responsive: true, cutout: '68%', plugins: { legend: { position: 'bottom', labels: { padding: 12, usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } } }
            });
        }

        // ===================================================================
        //  VIEW: TEACHER / ACADEMIC DESK
        // ===================================================================
        function renderTeacher(c) {
            c.innerHTML = `<div class="animate-view space-y-6">
                <!-- Header -->
                <div class="flex items-center justify-between">
                    <h3 class="text-2xl font-black text-slate-800 tracking-tight"><i class="fas fa-calendar-day mr-2 text-brand-600"></i>Today</h3>
                    <p class="text-xs font-bold text-slate-400">${new Date().toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</p>
                </div>

                <!-- Today's Classes + Recent Admissions -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800">Today's Classes</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <!-- Table Header -->
                        <div class="grid grid-cols-12 px-4 py-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">
                            <span class="col-span-1">✓</span>
                            <span class="col-span-4">Class / Subject</span>
                            <span class="col-span-3">Time</span>
                            <span class="col-span-2 text-center">Fee/Day</span>
                            <span class="col-span-2 text-right">Counter</span>
                        </div>
                        <div class="space-y-2">
                            ${[
                                { cls:'Grade 7 - Math', subj:'Mathematics', time:'9:00AM – 10:00pm', badge:'Basic Class', badgeCol:'emerald', stars:10, icon:'fa-calculator' },
                                { cls:'Grade 7 - Literature', subj:'Science', time:'10:00pm – 11:00am', badge:'Direct Class', badgeCol:'amber', stars:10, icon:'fa-flask' },
                            ].map(s => `
                                <div class="grid grid-cols-12 items-center px-4 py-3.5 bg-slate-50/60 rounded-2xl hover:bg-brand-50 transition-colors cursor-pointer group">
                                    <div class="col-span-1 flex items-center">
                                        <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                    </div>
                                    <div class="col-span-4 flex items-center gap-3">
                                        <div class="w-8 h-8 bg-brand-100 text-brand-600 rounded-lg flex items-center justify-center text-xs"><i class="fas ${s.icon}"></i></div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-700">${s.cls}</p>
                                            <p class="text-[11px] text-slate-400 font-medium">${s.subj}</p>
                                        </div>
                                    </div>
                                    <span class="col-span-3 text-xs font-medium text-slate-500">${s.time}</span>
                                    <div class="col-span-2 flex justify-center"><span class="badge bg-${s.badgeCol}-100 text-${s.badgeCol}-700">${s.badge}</span></div>
                                    <div class="col-span-2 flex items-center justify-end gap-1">
                                        <span class="text-sm font-black text-slate-700">${s.stars}</span>
                                        <span class="text-amber-400 text-xs"><i class="fas fa-star"></i></span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Recent Admissions -->
                    <div class="card p-8">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="font-black text-base text-slate-800">Recent Admissions</h4>
                            <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                        </div>
                        <div class="flex justify-around items-center py-6">
                            ${[
                                { n:'Tomorrow', col:'indigo' },
                                { n:'Future', col:'emerald' },
                                { n:'Measures', col:'amber' }
                            ].map(a => `
                                <div class="flex flex-col items-center gap-3">
                                    <img src="https://ui-avatars.com/api/?name=${a.n}&background=${a.col === 'indigo' ? 'eef2ff' : a.col === 'emerald' ? 'ecfdf5' : 'fffbeb'}&color=${a.col === 'indigo' ? '4f46e5' : a.col === 'emerald' ? '059669' : 'd97706'}&bold=true&size=56" class="w-14 h-14 rounded-full ring-4 ring-white shadow-lg">
                                    <span class="text-xs font-bold text-slate-600">${a.n}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <!-- Take Attendance + Right Column (Events & Lessons) -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Take Attendance -->
                    <div class="card p-8 lg:col-span-2">
                        <div class="flex justify-between items-center mb-5">
                            <h4 class="font-black text-base text-slate-800"><i class="fas fa-clipboard-check mr-2 text-brand-500"></i>Take Attendance</h4>
                            <div class="flex gap-2">
                                <span class="badge bg-brand-100 text-brand-700">Science</span>
                                <span class="badge bg-slate-100 text-slate-500">Grade/Percent: 5</span>
                            </div>
                        </div>
                        <!-- Table Header -->
                        <div class="grid grid-cols-12 px-4 py-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 border-b border-slate-100">
                            <span class="col-span-3">Student Name</span>
                            <span class="col-span-2">Surname</span>
                            <span class="col-span-2 text-center">Present</span>
                            <span class="col-span-2 text-center">Absent</span>
                            <span class="col-span-2 text-center">Tardiness</span>
                            <span class="col-span-1 text-center">Submit</span>
                        </div>
                        <div class="space-y-1">
                            ${[
                                { id:'Caro10.0140', sn:'—', present:true, p:100, t:'00' },
                                { id:'Caro10.010', sn:'—', present:true, p:10, t:'00' },
                                { id:'Caro16.01000', sn:'—', present:true, p:14, t:'00' },
                                { id:'Gard17.11a0000', sn:'—', present:true, p:12, t:'00' },
                                { id:'Caro17.U10004', sn:'—', present:true, p:24, t:'20' }
                            ].map(s => `
                                <div class="grid grid-cols-12 items-center px-4 py-3 bg-slate-50/40 rounded-xl hover:bg-brand-50/50 transition-colors">
                                    <span class="col-span-3 text-sm font-bold text-slate-700">${s.id}</span>
                                    <span class="col-span-2 text-sm text-slate-400 font-medium">${s.sn}</span>
                                    <div class="col-span-2 flex justify-center">
                                        <div class="w-5 h-5 ${s.present ? 'bg-emerald-500' : 'bg-slate-200'} rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                    </div>
                                    <div class="col-span-2 flex justify-center">
                                        <span class="text-sm font-bold text-slate-700">${s.p}</span>
                                    </div>
                                    <div class="col-span-2 flex justify-center">
                                        <span class="text-sm font-medium text-slate-500">${s.t}</span>
                                    </div>
                                    <div class="col-span-1 flex justify-center">
                                        <div class="w-5 h-5 bg-emerald-500 rounded-md flex items-center justify-center"><i class="fas fa-check text-white text-[9px]"></i></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <!-- Footer -->
                        <div class="flex items-center justify-between mt-5 pt-4 border-t border-slate-100">
                            <span class="text-sm font-bold text-slate-500"><i class="fas fa-users mr-2 text-brand-500"></i>Count Group: <strong class="text-slate-800">3</strong></span>
                            <div class="flex gap-2">
                                <button class="px-6 py-2.5 bg-brand-600 text-white font-black text-xs rounded-xl hover:bg-brand-500 transition-all shadow-lg shadow-brand-600/20">Save/Export</button>
                                <button class="px-4 py-2.5 bg-slate-100 text-slate-600 font-black text-xs rounded-xl hover:bg-slate-200 transition-all"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Upcoming Events + Upcoming Lessons -->
                    <div class="space-y-6">
                        <!-- Upcoming Events -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800">Upcoming Events</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="space-y-3">
                                ${[
                                    { t:'10 o\'clock', sub:'Canteen', done:true },
                                    { t:'Test Friday', sub:'Interviews', done:true }
                                ].map(e => `
                                    <div class="flex items-center gap-3 p-3 bg-slate-50/60 rounded-xl hover:bg-brand-50/50 transition-colors cursor-pointer">
                                        <div class="w-5 h-5 ${e.done ? 'bg-emerald-500' : 'bg-slate-200'} rounded-md flex items-center justify-center shrink-0"><i class="fas fa-check text-white text-[9px]"></i></div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-700">${e.t}</p>
                                            <p class="text-[11px] text-slate-400 font-medium">${e.sub}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Upcoming Lessons -->
                        <div class="card p-8">
                            <div class="flex justify-between items-center mb-5">
                                <h4 class="font-black text-base text-slate-800">Upcoming Lessons</h4>
                                <button class="text-slate-400 hover:text-slate-600 text-xs"><i class="fas fa-ellipsis"></i></button>
                            </div>
                            <div class="space-y-3">
                                ${[
                                    { t:'District Day', sub:'Conference', col:'indigo' },
                                    { t:'History', sub:'Master/Slay', col:'amber' }
                                ].map(l => `
                                    <div class="flex items-center gap-3 p-3 bg-${l.col}-50 rounded-xl border-l-4 border-${l.col}-500 cursor-pointer hover:shadow-md transition-all">
                                        <div class="w-8 h-8 bg-${l.col}-100 text-${l.col}-600 rounded-lg flex items-center justify-center text-xs"><i class="fas fa-book-open"></i></div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-700">${l.t}</p>
                                            <p class="text-[11px] text-slate-400 font-medium">${l.sub}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // ===================================================================
        //  VIEW: LIBRARY
        // ===================================================================
        function renderLibrary(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('Total Books','24,580','fa-book','indigo','+340 this month','up')}
                    ${statCard('Checked Out','1,842','fa-book-open','amber','14.2% overdue','down')}
                    ${statCard('Digital Resources','8,420','fa-laptop','sky','+560 new','up')}
                    ${statCard('Active Members','4,210','fa-id-card','emerald','92% students','up')}
                </div>
                <div class="card p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h4 class="font-black text-sm text-slate-700"><i class="fas fa-search mr-2 text-brand-500"></i>Catalog Search</h4>
                    </div>
                    <div class="flex gap-4 mb-8">
                        <input type="text" placeholder="Search by title, author, or ISBN..." class="flex-1 p-4 bg-slate-50 rounded-2xl font-bold outline-none border-2 border-transparent focus:border-brand-500 transition-all">
                        <select class="p-4 bg-slate-50 rounded-2xl font-bold outline-none border-2 border-transparent focus:border-brand-500"><option>All Categories</option><option>Science</option><option>Literature</option><option>History</option><option>Technology</option></select>
                        <button class="px-6 bg-brand-600 text-white rounded-2xl font-black hover:bg-brand-500 transition-all">Search</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                        ${[
                            { t:'Advanced Physics', a:'Richard Feynman', cat:'Science', avail: 4, total: 8, col:'indigo' },
                            { t:'Calculus Made Easy', a:'Silvanus P. Thompson', cat:'Mathematics', avail: 12, total: 15, col:'amber' },
                            { t:'To Kill a Mockingbird', a:'Harper Lee', cat:'Literature', avail: 0, total: 6, col:'rose' },
                            { t:'Clean Code', a:'Robert C. Martin', cat:'Technology', avail: 3, total: 5, col:'emerald' },
                            { t:'World History Vol. III', a:'J.M. Roberts', cat:'History', avail: 7, total: 10, col:'sky' },
                            { t:'The Art of War', a:'Sun Tzu', cat:'Philosophy', avail: 2, total: 4, col:'violet' }
                        ].map(b => `
                            <div class="p-5 bg-slate-50 rounded-2xl hover:bg-white hover:shadow-md transition-all border border-transparent hover:border-slate-100 cursor-pointer">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="w-10 h-10 bg-${b.col}-100 text-${b.col}-600 rounded-xl flex items-center justify-center"><i class="fas fa-book text-sm"></i></div>
                                    <span class="badge ${b.avail > 0 ? 'bg-emerald-100 text-emerald-700' : 'bg-red-100 text-red-700'}">${b.avail > 0 ? b.avail+' available' : 'Checked out'}</span>
                                </div>
                                <h5 class="font-black text-slate-800 text-sm mb-1">${b.t}</h5>
                                <p class="text-xs text-slate-400 font-medium">${b.a} &bull; ${b.cat}</p>
                                <div class="mt-3 w-full h-1.5 bg-slate-200 rounded-full overflow-hidden"><div class="h-full bg-${b.col}-500 rounded-full" style="width:${(b.avail/b.total)*100}%"></div></div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>`;
        }

        // ===================================================================
        //  VIEW: FLEET SYNC / TRANSPORT
        // ===================================================================
        function renderTransport(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('Active Buses','32','fa-bus','indigo','28 on route','up')}
                    ${statCard('Students Served','6,420','fa-users','emerald','98% coverage','up')}
                    ${statCard('Total Routes','48','fa-route','sky','All optimized','up')}
                    ${statCard('Maintenance Due','4','fa-wrench','amber','2 urgent','down')}
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6"><i class="fas fa-satellite-dish mr-2 text-brand-500"></i>Live Fleet Status</h4>
                        <div class="space-y-3">
                            ${[
                                { id:'BUS-01', r:'Route A — Downtown Circuit', d:'James Wilson', s:'On Route', sc:'emerald', icon:'fa-circle-dot' },
                                { id:'BUS-02', r:'Route B — Eastside Loop', d:'Maria Garcia', s:'On Route', sc:'emerald', icon:'fa-circle-dot' },
                                { id:'BUS-07', r:'Route G — North Hills', d:'Robert Lee', s:'Maintenance', sc:'red', icon:'fa-wrench' },
                                { id:'BUS-12', r:'Route L — Airport Road', d:'Priya Sharma', s:'On Route', sc:'emerald', icon:'fa-circle-dot' },
                                { id:'BUS-15', r:'Route O — University Belt', d:'Tom Davis', s:'Returning', sc:'amber', icon:'fa-rotate-left' },
                                { id:'BUS-22', r:'Route V — Lakeside', d:'Anna Kowalski', s:'Standby', sc:'slate', icon:'fa-pause' }
                            ].map(b => `
                                <div class="table-row">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 bg-${b.sc}-100 text-${b.sc}-600 rounded-xl flex items-center justify-center text-sm"><i class="fas ${b.icon}"></i></div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-700">${b.id} — ${b.r}</p>
                                            <p class="text-xs text-slate-400">Driver: ${b.d}</p>
                                        </div>
                                    </div>
                                    <span class="badge bg-${b.sc}-100 text-${b.sc}-700">${b.s}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Fuel & Distance Analytics</h4>
                        <canvas id="fleetChart" height="230"></canvas>
                    </div>
                </div>
            </div>`;

            makeChart('fleetChart', {
                type: 'bar',
                data: { labels: ['Mon','Tue','Wed','Thu','Fri'], datasets: [
                    { label: 'Distance (km)', data: [1240,1180,1310,1280,1350], backgroundColor: '#4f46e5', borderRadius: 6, barPercentage: 0.5 },
                    { label: 'Fuel (L)', data: [340,320,360,350,370], backgroundColor: '#f59e0b', borderRadius: 6, barPercentage: 0.5 }
                ] },
                options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 } } }, y: { grid: { color: '#f1f5f9' }, ticks: { font: { weight: 700, size: 10 } } } } }
            });
        }

        // ===================================================================
        //  VIEW: INVENTORY / STOCK LOGIC
        // ===================================================================
        function renderInventory(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('Total Items','8,640','fa-boxes-stacked','indigo','All tracked','up')}
                    ${statCard('Low Stock','23','fa-triangle-exclamation','amber','Action needed','down')}
                    ${statCard('Orders Pending','7','fa-truck-loading','sky','3 arriving today','up')}
                    ${statCard('Total Value','$1.2M','fa-tag','emerald','Audited Dec 1','up')}
                </div>
                <div class="card p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h4 class="font-black text-sm text-slate-700"><i class="fas fa-boxes-stacked mr-2 text-brand-500"></i>Inventory Overview</h4>
                        <div class="flex gap-2">
                            <button class="badge bg-brand-100 text-brand-700 hover:bg-brand-200 transition-colors cursor-pointer">+ New Item</button>
                            <button class="badge bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors cursor-pointer">Export</button>
                        </div>
                    </div>
                    <div class="grid grid-cols-6 px-6 py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">
                        <span class="col-span-2">Item</span><span>Category</span><span class="text-center">Stock</span><span class="text-center">Status</span><span class="text-right">Value</span>
                    </div>
                    <div class="space-y-2">
                        ${[
                            { n:'Lab Microscopes', cat:'Equipment', stock:45, min:10, val:'$67,500' },
                            { n:'Whiteboard Markers', cat:'Supplies', stock:8, min:50, val:'$240' },
                            { n:'Student Desks', cat:'Furniture', stock:120, min:20, val:'$36,000' },
                            { n:'Printer Cartridges', cat:'IT Supplies', stock:3, min:15, val:'$450' },
                            { n:'Chemistry Reagents', cat:'Lab', stock:28, min:25, val:'$4,200' },
                            { n:'Sports Equipment Set', cat:'Athletics', stock:15, min:5, val:'$7,500' },
                            { n:'Library Books (Batch)', cat:'Library', stock:340, min:100, val:'$10,200' }
                        ].map(it => {
                            const status = it.stock <= it.min * 0.3 ? { l:'Critical', c:'red' } : it.stock <= it.min ? { l:'Low', c:'amber' } : { l:'In Stock', c:'emerald' };
                            return `<div class="grid grid-cols-6 items-center px-6 py-4 bg-slate-50/50 rounded-2xl hover:bg-brand-50 transition-colors cursor-pointer">
                                <span class="col-span-2 text-sm font-bold text-slate-700">${it.n}</span>
                                <span class="text-xs font-medium text-slate-500">${it.cat}</span>
                                <span class="text-center text-sm font-black text-slate-700">${it.stock}</span>
                                <span class="text-center"><span class="badge bg-${status.c}-100 text-${status.c}-700">${status.l}</span></span>
                                <span class="text-right text-sm font-bold text-slate-600">${it.val}</span>
                            </div>`;
                        }).join('')}
                    </div>
                </div>
            </div>`;
        }

        // ===================================================================
        //  VIEW: ASSESSMENT ENGINE / EXAMS
        // ===================================================================
        function renderExams(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('Upcoming Exams','12','fa-file-circle-check','indigo','Next: Dec 20','up')}
                    ${statCard('Avg Pass Rate','87.3%','fa-chart-line','emerald','+2.4%','up')}
                    ${statCard('Papers Graded','2,840','fa-check-double','sky','94% complete','up')}
                    ${statCard('Pending Reviews','156','fa-hourglass-half','amber','Due Dec 18','down')}
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card p-8 lg:col-span-2">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Pass Rate by Subject</h4>
                        <canvas id="examChart" height="140"></canvas>
                    </div>
                    <div class="card p-8">
                        <h4 class="font-black text-sm text-slate-700 mb-6">Grade Distribution</h4>
                        <canvas id="gradeDistChart" height="220"></canvas>
                    </div>
                </div>
                <div class="card p-8">
                    <h4 class="font-black text-sm text-slate-700 mb-6"><i class="fas fa-calendar-days mr-2 text-brand-500"></i>Upcoming Examinations</h4>
                    <div class="space-y-3">
                        ${[
                            { s:'Mathematics Final', g:'Grade 10-12', d:'Dec 20, 2024', t:'09:00 — 12:00', st:'Scheduled', sc:'indigo' },
                            { s:'Physics Midterm', g:'Grade 11', d:'Dec 22, 2024', t:'10:00 — 12:30', st:'Scheduled', sc:'sky' },
                            { s:'English Literature', g:'Grade 9-10', d:'Dec 23, 2024', t:'09:00 — 11:00', st:'Scheduled', sc:'amber' },
                            { s:'Chemistry Practical', g:'Grade 11-12', d:'Jan 5, 2025', t:'14:00 — 17:00', st:'Draft', sc:'slate' },
                            { s:'Computer Science', g:'Grade 10-12', d:'Jan 8, 2025', t:'09:00 — 11:30', st:'Draft', sc:'slate' }
                        ].map(e => `
                            <div class="table-row">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-${e.sc}-100 text-${e.sc}-600 rounded-xl flex items-center justify-center text-sm"><i class="fas fa-file-alt"></i></div>
                                    <div><p class="text-sm font-bold text-slate-700">${e.s}</p><p class="text-xs text-slate-400">${e.g} &bull; ${e.d} &bull; ${e.t}</p></div>
                                </div>
                                <span class="badge bg-${e.sc}-100 text-${e.sc}-700">${e.st}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>`;

            makeChart('examChart', {
                type: 'bar',
                data: { labels: ['Math','Physics','English','Chemistry','History','Comp Sci','Biology'], datasets: [
                    { label: 'Pass Rate %', data: [91,84,93,79,88,86,90], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#ec4899','#10b981','#8b5cf6','#f97316'], borderRadius: 8, barPercentage: 0.6 }
                ] },
                options: { responsive: true, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { font: { weight: 700, size: 10 } } }, y: { grid: { color: '#f1f5f9' }, max: 100, ticks: { callback: v => v+'%', font: { weight: 700, size: 10 } } } } }
            });
            makeChart('gradeDistChart', {
                type: 'doughnut',
                data: { labels: ['A+/A','B+/B','C+/C','D','F'], datasets: [{ data: [28,35,22,10,5], backgroundColor: ['#4f46e5','#06b6d4','#f59e0b','#f97316','#ef4444'], borderWidth: 0 }] },
                options: { responsive: true, cutout: '68%', plugins: { legend: { position: 'bottom', labels: { padding: 12, usePointStyle: true, pointStyle: 'circle', font: { weight: 700, size: 10 } } } } }
            });
        }

        // ===================================================================
        //  VIEW: API GATEWAY
        // ===================================================================
        function renderAPI(c) {
            c.innerHTML = `<div class="animate-view space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    ${statCard('API Uptime','99.97%','fa-signal','emerald','30-day avg','up')}
                    ${statCard('Requests/min','4,280','fa-bolt','indigo','Peak: 8.2K','up')}
                    ${statCard('Avg Latency','42ms','fa-gauge-high','sky','-8ms from avg','up')}
                    ${statCard('Error Rate','0.03%','fa-bug','emerald','Within SLA','up')}
                </div>
                <div class="card p-8">
                    <h4 class="font-black text-sm text-slate-700 mb-6">API Traffic (24h)</h4>
                    <canvas id="apiChart" height="100"></canvas>
                </div>
                <div class="card p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h4 class="font-black text-sm text-slate-700"><i class="fas fa-code-branch mr-2 text-brand-500"></i>Endpoint Registry</h4>
                        <span class="badge bg-emerald-100 text-emerald-700">All Systems Operational</span>
                    </div>
                    <div class="space-y-3">
                        ${[
                            { m:'GET', e:'/api/v3/students', d:'Student records', l:'12ms', s:'200', r:'2.4K/min' },
                            { m:'POST', e:'/api/v3/enrollment', d:'New enrollment', l:'45ms', s:'201', r:'180/min' },
                            { m:'GET', e:'/api/v3/grades', d:'Grade retrieval', l:'18ms', s:'200', r:'1.8K/min' },
                            { m:'PUT', e:'/api/v3/attendance', d:'Attendance update', l:'32ms', s:'200', r:'960/min' },
                            { m:'GET', e:'/api/v3/finance/summary', d:'Finance overview', l:'68ms', s:'200', r:'420/min' },
                            { m:'DELETE', e:'/api/v3/cache', d:'Cache purge', l:'8ms', s:'204', r:'12/min' }
                        ].map(ep => `
                            <div class="grid grid-cols-6 items-center px-6 py-4 bg-slate-50/50 rounded-2xl hover:bg-brand-50 transition-colors cursor-pointer">
                                <span class="badge w-fit ${ep.m === 'GET' ? 'bg-emerald-100 text-emerald-700' : ep.m === 'POST' ? 'bg-blue-100 text-blue-700' : ep.m === 'PUT' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}">${ep.m}</span>
                                <span class="col-span-2 text-sm font-mono font-bold text-slate-700">${ep.e}</span>
                                <span class="text-xs text-slate-500">${ep.l} avg</span>
                                <span class="text-center badge w-fit bg-emerald-100 text-emerald-700">${ep.s}</span>
                                <span class="text-right text-xs font-bold text-slate-500">${ep.r}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>`;

            makeChart('apiChart', {
                type: 'line',
                data: { labels: Array.from({length:24}, (_,i) => `${String(i).padStart(2,'0')}:00`),
                    datasets: [{ label: 'Requests', data: [1200,800,420,280,220,180,340,1800,3200,4100,4280,3900,3600,4000,4200,4100,3800,3200,2800,2400,2100,1900,1600,1400], borderColor: '#4f46e5', backgroundColor: 'rgba(79,70,229,0.06)', fill: true, tension: 0.4, pointRadius: 0, borderWidth: 2.5 }]
                },
                options: { responsive: true, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { maxTicksLimit: 8, font: { weight: 700, size: 9 } } }, y: { grid: { color: '#f1f5f9' }, ticks: { font: { weight: 700, size: 9 } } } } }
            });
        }

        // ===================================================================
        //  PLACEHOLDER
        // ===================================================================
        function renderPlaceholder(c, label) {
            c.innerHTML = `<div class="animate-view flex items-center justify-center h-full"><div class="text-center"><div class="w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6"><i class="fas fa-cubes text-4xl text-slate-300"></i></div><h3 class="text-2xl font-black text-slate-300 tracking-tight">${label}</h3><p class="text-slate-400 mt-2 font-medium">Module coming soon</p></div></div>`;
        }

        // ===================================================================
        //  LUMINA AI CHAT
        // ===================================================================
        function quickAsk(q) { document.getElementById('aiChatInput').value = q; sendToLumina(); }

        async function sendToLumina() {
            const input = document.getElementById('aiChatInput');
            const chat = document.getElementById('chatWindow');
            if (!input.value.trim()) return;
            const userQuery = input.value.trim();

            // User message
            chat.innerHTML += `<div class="p-4 bg-slate-100 rounded-3xl rounded-tr-lg text-sm font-bold text-slate-700 shadow-sm">${userQuery}</div>`;
            input.value = "";

            // Typing indicator
            const typingId = 'typing-' + Date.now();
            chat.innerHTML += `<div id="${typingId}" class="flex gap-1.5 p-4"><span class="w-2.5 h-2.5 bg-indigo-400 rounded-full typing-dot"></span><span class="w-2.5 h-2.5 bg-indigo-400 rounded-full typing-dot"></span><span class="w-2.5 h-2.5 bg-indigo-400 rounded-full typing-dot"></span></div>`;
            chat.scrollTop = chat.scrollHeight;

            const q = userQuery.toLowerCase();
            let res = '';

            setTimeout(() => {
                document.getElementById(typingId)?.remove();

                if (q.includes('enroll') || q.includes('student') || q.includes('registration'))
                    res = `📊 <strong>Enrollment Analytics:</strong><br><br>• Current enrollment: <strong>12,847 students</strong> (+3.2% YoY)<br>• New admissions this month: <strong>180</strong><br>• Retention rate: <strong>96.8%</strong><br>• Waitlist: <strong>342 applicants</strong><br><br>Science dept leads with 35% of total enrollment. Shall I generate the full breakdown?`;
                else if (q.includes('fee') || q.includes('finance') || q.includes('revenue') || q.includes('payment'))
                    res = `💰 <strong>Finance Overview:</strong><br><br>• Term revenue: <strong>$2.4M</strong> (+12.5%)<br>• Outstanding fees: <strong>$186K</strong> (92% collected)<br>• 12 students overdue &gt; 30 days<br>• Govt grant pending: <strong>$50K</strong><br><br>Recommendation: Send automated reminders to overdue accounts this week.`;
                else if (q.includes('grade') || q.includes('score') || q.includes('academic') || q.includes('perform'))
                    res = `📈 <strong>Academic Performance:</strong><br><br>• Institution GPA: <strong>3.42</strong> (up from 3.38)<br>• Top subject: Computer Science (<strong>86%</strong> avg)<br>• Needs attention: Chemistry (<strong>79%</strong> pass rate)<br>• Honor roll students: <strong>1,284</strong> (10% of student body)<br><br>Trend analysis shows Grade 10 improved most significantly this semester.`;
                else if (q.includes('attend'))
                    res = `📋 <strong>Attendance Report:</strong><br><br>• Today's average: <strong>94.6%</strong><br>• Grades 7-9 showing -1.2% dip (possible seasonal illness)<br>• Perfect attendance streak: <strong>847 students</strong><br>• Chronic absentees (>10%): <strong>23 students</strong><br><br>⚠️ Recommend: Activate health protocols for middle school.`;
                else if (q.includes('top') || q.includes('best') || q.includes('performer'))
                    res = `🏆 <strong>Top Performers — Current Term:</strong><br><br>1. <strong>Michael Sterling</strong> — GPA 3.88 (Grade 10A)<br>2. <strong>Sarah Kim</strong> — GPA 3.85 (Grade 12B)<br>3. <strong>James Chen</strong> — GPA 3.82 (Grade 11A)<br>4. <strong>Emma Wilson</strong> — GPA 3.80 (Grade 10C)<br>5. <strong>Alex Doe</strong> — GPA 3.79 (Grade 12A)<br><br>3 of the top 5 are eligible for academic scholarships.`;
                else if (q.includes('bus') || q.includes('transport') || q.includes('fleet') || q.includes('route'))
                    res = `🚌 <strong>Fleet Status:</strong><br><br>• Active buses: <strong>28/32</strong> currently on route<br>• BUS-07: In maintenance (brake inspection)<br>• Average route time today: <strong>42 min</strong> (-3 min from avg)<br>• Fuel efficiency: <strong>3.7 km/L</strong><br><br>All GPS trackers online. Next scheduled maintenance: BUS-15 on Friday.`;
                else if (q.includes('librar') || q.includes('book'))
                    res = `📚 <strong>Library Analytics:</strong><br><br>• Collection size: <strong>24,580 volumes</strong><br>• Currently checked out: <strong>1,842</strong><br>• Overdue returns: <strong>262</strong> (14.2%)<br>• Most borrowed: "Clean Code" by R. Martin<br>• Digital resource usage up <strong>23%</strong> this month<br><br>Suggest: Expand the Computer Science section based on demand trends.`;
                else if (q.includes('inventory') || q.includes('stock') || q.includes('supply'))
                    res = `📦 <strong>Inventory Alert:</strong><br><br>• <strong>23 items</strong> below minimum threshold<br>• Critical: Printer Cartridges (3 remaining)<br>• Critical: Whiteboard Markers (8 remaining)<br>• Total inventory value: <strong>$1.2M</strong><br>• 7 purchase orders pending delivery<br><br>Action: Auto-reorder initiated for 5 critical items.`;
                else if (q.includes('exam') || q.includes('test') || q.includes('assessment'))
                    res = `📝 <strong>Assessment Summary:</strong><br><br>• Next exam: Mathematics Final — <strong>Dec 20</strong><br>• Papers graded: <strong>2,840/3,020</strong> (94%)<br>• Average pass rate: <strong>87.3%</strong> (+2.4%)<br>• 156 reviews pending (deadline: Dec 18)<br><br>Grade 12 finals preparation on track. All question papers approved.`;
                else if (q.includes('help') || q.includes('what can'))
                    res = `🤖 I can help with:<br><br>• <strong>Enrollment</strong> — student counts, trends, waitlists<br>• <strong>Finance</strong> — revenue, fees, budgets<br>• <strong>Academics</strong> — grades, pass rates, top performers<br>• <strong>Attendance</strong> — daily reports, patterns, alerts<br>• <strong>Transport</strong> — fleet status, routes, maintenance<br>• <strong>Library</strong> — catalog, borrowing analytics<br>• <strong>Inventory</strong> — stock levels, reorder alerts<br>• <strong>Exams</strong> — schedules, results, grading progress<br><br>Just ask in natural language!`;
                else
                    res = `I've analyzed your query across all 13 core modules. Here's what I found:<br><br>• System health: <strong>All modules operational</strong><br>• Firebase connection: <strong>Active</strong><br>• Last sync: <strong>${new Date().toLocaleTimeString()}</strong><br><br>Could you be more specific? Try asking about <em>enrollment</em>, <em>finance</em>, <em>attendance</em>, <em>grades</em>, or <em>transport</em>.`;

                chat.innerHTML += `<div class="p-5 bg-brand-600 text-white rounded-3xl rounded-tl-lg text-sm font-medium shadow-xl leading-relaxed">
                    <p class="font-black text-[10px] uppercase tracking-widest mb-2 opacity-70">Lumina AI</p>${res}</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 600 + Math.random() * 800);
        }
    </script>
</body>
</html>